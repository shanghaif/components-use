(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5273"],{"/vH7":function(t,e,i){"use strict";var n=i("v6BD");i.n(n).a},Ynr8:function(t,e,i){"use strict";i.r(e);i("v0iw"),i("MT78"),i("xiB2");var n,o,s={name:"OnlineTest",data:function(){return{primary:!0,status:"active",value4:!0,contentData:[],devices:{device:""},editor1:{function:"",method:""},editor2:{function:"",method:""},primary2active:!0,primary1:1,isactive:!1,primary1form:{status:""}}},mounted:function(){(n=ace.edit("editor1")).session.setMode("ace/mode/json"),n.setTheme("ace/theme/eclipse"),n.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0})},methods:{sendZl:function(){},setJson:function(){},functionClick:function(){this.primary1=3,setTimeout(function(){(o=ace.edit("editor2")).session.setMode("ace/mode/json"),o.setTheme("ace/theme/eclipse"),o.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0})},300)}}},a=(i("/vH7"),i("KHd+")),l=Object(a.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"onlinetest"},[n("div",{staticClass:"onlinetest_top"},[n("div",[n("el-form",{attrs:{model:t.devices,"label-width":"100px",inline:!0,size:"mini"}},[n("el-form-item",{attrs:{label:"请选择设备"}},[n("el-select",{model:{value:t.devices.device,callback:function(e){t.$set(t.devices,"device",e)},expression:"devices.device"}},[n("el-option")],1)],1),t._v(" "),n("el-form-item",[n("el-select",{model:{value:t.devices.device,callback:function(e){t.$set(t.devices,"device",e)},expression:"devices.device"}},[n("el-option")],1)],1)],1)],1),t._v(" "),n("div",{staticClass:"top_content"},[n("span",{staticStyle:{display:"inline-block","font-size":"20px","font-weight":"900"}},[t._v("实时日志")]),t._v(" "),n("span",{staticClass:"status",class:t.status}),t._v(" "),n("span",{staticStyle:{"font-size":"14px",color:"grey"}},[t._v("(未激活)真实设备")]),t._v(" "),n("div",{staticStyle:{float:"right"}},[n("el-switch",{staticStyle:{display:"inline-block","margin-right":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"自动刷新"},model:{value:t.value4,callback:function(e){t.value4=e},expression:"value4"}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"medium"}},[t._v("刷新")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"medium"}},[t._v("清屏")])],1),t._v(" "),n("div",{staticClass:"tableforcontent",staticStyle:{"margin-top":"20px"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contentData,height:"250"}},[n("el-table-column",{attrs:{prop:"date",label:"类型 / 时间",width:"300"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"时间"}})],1)],1)])]),t._v(" "),n("div",{staticClass:"onlinetest_bottom"},[n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"调试真实设备"}},[n("div",{staticClass:"bottom1_top"},[n("el-button-group",[n("el-button",{attrs:{type:1==t.primary?"primary":"info",size:"mini",plain:""},on:{click:function(e){t.primary=!0}}},[t._v("属性调试")]),t._v(" "),n("el-button",{attrs:{type:0==t.primary?"primary":"info",size:"mini",plain:""},on:{click:function(e){t.primary=!1}}},[t._v("服务调用")])],1),t._v(" "),n("div",[n("div",{staticClass:"editorheader"},[n("el-form",{attrs:{model:t.editor1,inline:!0,"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"调试功能"}},[n("el-select",{attrs:{clear:t.clearEditor1},model:{value:t.editor1.function,callback:function(e){t.$set(t.editor1,"function",e)},expression:"editor1.function"}},[n("el-option",{attrs:{label:"11111",value:"2222"}})],1)],1),t._v(" "),1==t.primary?n("div",{staticStyle:{display:"inline-block"}},[n("el-form-item",{attrs:{label:"功能"}},[n("el-select",{model:{value:t.editor1.method,callback:function(e){t.$set(t.editor1,"method",e)},expression:"editor1.method"}},[n("el-option")],1)],1)],1):t._e()],1)],1),t._v(" "),n("div",{staticStyle:{background:"#ffffff"}},[n("label",{attrs:{id:"plug-name"}})]),t._v(" "),n("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor1"}},[n("textarea",{staticClass:"ace_text-input"})]),t._v(" "),n("div",[""==t.editor1.function?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请选择功能",placement:"top-start"}},[n("span",[n("el-button",{attrs:{type:"info",plain:"",size:"mini",disabled:""==t.editor1.function}},[t._v("发送指令")])],1)]):n("el-button",{attrs:{type:"info",plain:"",size:"mini",disabled:""==t.editor1.function}},[t._v("发送指令")]),t._v(" "),n("el-button",{attrs:{type:"info",plain:"",size:"mini",disabled:""==t.editor1.function}},[t._v("重置")])],1)])],1)]),t._v(" "),n("el-tab-pane",{attrs:{label:"调试虚拟设备"}},[n("div",{staticClass:"editor2header"},[1==t.isactive?n("div",{staticClass:"editor2show animated fadeIn"},[n("el-button-group",[n("el-button",{attrs:{type:1==t.primary1?"primary":"info",size:"mini",plain:""},on:{click:function(e){t.primary1=1}}},[t._v("属性上报")]),t._v(" "),n("el-button",{attrs:{type:2==t.primary1?"primary":"info",size:"mini",plain:""},on:{click:function(e){t.primary1=2}}},[t._v("事件上报")]),t._v(" "),n("el-button",{attrs:{type:3==t.primary1?"primary":"info",size:"mini",plain:""},on:{click:t.functionClick}},[t._v("属性调试")]),t._v(" "),n("el-button",{attrs:{type:4==t.primary1?"primary":"info",size:"mini",plain:""},on:{click:function(e){t.primary1=4}}},[t._v("服务调用")])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.primary1,expression:"primary1==1"}],staticClass:"primary1 "},[n("el-form",{attrs:{model:t.primary1form,size:"mini"}},[n("el-form-item",{attrs:{label:"lightStatus"}},[n("el-select",{model:{value:t.primary1form.status,callback:function(e){t.$set(t.primary1form,"status",e)},expression:"primary1form.status"}},[n("el-option",{attrs:{label:"11111",value:"2222"}})],1)],1),t._v(" "),n("div",{staticClass:"primary1content"}),t._v(" "),n("div",{staticClass:"primary1bottom"},[n("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("推送")]),t._v(" "),n("el-button",{attrs:{type:"info",size:"mini",plain:""}},[t._v("策略推送")]),t._v(" "),n("el-button",{attrs:{type:"info",size:"mini",plain:""},on:{click:function(e){t.isactive=!1}}},[t._v("关闭虚拟设备")]),t._v(" "),n("el-button",{attrs:{type:"info",size:"mini",plain:""}},[t._v("查看数据")])],1)],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.primary1,expression:"primary1==2"}],staticClass:"primary2 animated fadeInUp"},[n("img",{staticStyle:{height:"80px",width:"100px"},attrs:{src:i("lgKv"),alt:""}}),t._v(" "),n("div",{staticStyle:{"margin-top":"20px","font-size":"20px","margin-bottom":"20px",color:"#73777a"}},[t._v("暂无数据")]),t._v(" "),n("div",[n("el-button",{attrs:{type:"primary",size:"small"}},[t._v("编辑物模型")]),t._v(" "),n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(e){t.isactive=!1}}},[t._v("关闭设备")])],1)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:3==t.primary1||4==t.primary1,expression:"primary1==3||primary1==4"}],staticClass:"primary3"},[n("div",{staticClass:"editorheader"},[n("el-form",{attrs:{model:t.editor2,inline:!0,"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"调试功能"}},[n("el-select",{model:{value:t.editor2.function,callback:function(e){t.$set(t.editor2,"function",e)},expression:"editor2.function"}},[n("el-option",{attrs:{label:"11111",value:"2222"}})],1)],1),t._v(" "),3==t.primary1?n("div",{staticStyle:{display:"inline-block"}},[n("el-form-item",{attrs:{label:"功能"}},[n("el-select",{model:{value:t.editor2.method,callback:function(e){t.$set(t.editor2,"method",e)},expression:"editor2.method"}},[n("el-option")],1)],1)],1):t._e()],1)],1),t._v(" "),n("div",{staticStyle:{background:"#ffffff"}},[n("label",{attrs:{id:"plug-name"}})]),t._v(" "),n("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor2"}},[n("textarea",{staticClass:"ace_text-input"})]),t._v(" "),n("div",[""==t.editor2.function?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请选择功能",placement:"top-start"}},[n("span",[n("el-button",{attrs:{type:"info",plain:"",size:"mini",disabled:""==t.editor2.function}},[t._v("发送指令")])],1)]):n("el-button",{attrs:{type:"info",plain:"",size:"mini"}},[t._v("发送指令")]),t._v(" "),n("el-button",{attrs:{type:"info",plain:"",size:"mini"}},[t._v("重置")])],1)])],1):n("div",{staticClass:"editor2hidden animated fadeInDown"},[n("img",{staticStyle:{height:"80px",width:"100px"},attrs:{src:i("lgKv"),alt:""}}),t._v(" "),n("div",{staticStyle:{"margin-top":"20px","font-size":"20px"}},[t._v("调试虚拟设备")]),t._v(" "),n("div",{staticStyle:{"text-align":"center","font-size":"14px",color:"#73777a","margin-top":"8px","margin-bottom":"20px"}},[t._v("虚拟设备可以模拟真实设备在云端建立连接，上报定义的属性及事件处理，"),n("br"),t._v("这样可以不依赖真实设备快速开发应用")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.isactive=!0}}},[t._v("启动真实设备")])],1)])])],1)],1)])},[],!1,null,"a1113518",null);l.options.__file="onlinetest.vue";e.default=l.exports},lgKv:function(t,e,i){t.exports=i.p+"static/img/logo2.847cc43.png"},v6BD:function(t,e,i){},xiB2:function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return l}),i.d(e,"c",function(){return s});var n=sessionStorage.getItem("token"),o={topic:"web/"+n,qos:2};function s(t){o={topic:"web/"+(n=t),qos:2}}function a(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var n in i)if(new RegExp("("+n+")").test(e)){var o=i[n]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?o:c(o))}return e}var l=[];function c(t){return("00"+t).substr(t.length)}var r={modName:"websocket",client:null,connState:!1,cInfo:{host:location.hostname,port:8083,clientId:"C_"+(new Date).getTime(),userName:"test",password:"test123",keepAlive:null,keepAliveInterval:10,cleanSession:!1},sendInfo:"{}",tablelist:[],subInfo:o,originrecivedata:[],send:function(){var t=JSON.parse(this.sendInfo);console.log(t),this.sendMessage(t)},log:function(t){try{t=JSON.parse(t)}catch(t){}console.log(111)},newClient:function(){this.client=new Paho.MQTT.Client(this.cInfo.host,Number(this.cInfo.port),this.cInfo.clientId)},sslPort:function(){var t=this.cInfo.useSSL;this.cInfo.port=t?8084:8083},recive:function(t){console.log(t)},connect:function(){var t=this;if(!t.client.isConnected()){t.client.onConnectionLost=function(e){0!==e.errorCode?(console.log("onConnectionLost: "+e.errorMessage),setTimeout(function(){t.connect()},5e3)):window.clearTimeout()},t.client.onMessageArrived=function(e){try{e.msgString=e.payloadString}catch(t){e.msgString="Binary message("+e.payloadBytes.length+")"}t.recive(e.payloadString)};var e={onFailure:function(e){t.connState=!1,console.log("连接失败 "+e.errorMessage),setTimeout(function(){t.connect()},5e3)},onSuccess:function(){t.connState=!0,t.subscribe(t.subInfo,function(e){e.result&&(console.log(t.subInfo),console.log("订阅成功"))})}},i=t.cInfo.userName,n=t.cInfo.password,o=t.cInfo.keepAlive,s=t.cInfo.cleanSession;i&&(e.userName=i),n&&(e.password=n),o&&(e.keepAliveInterval=Number(o)),e.cleanSession=s,t.client.connect(e)}},disconnect:function(){var t=this;t.client&&this.client.isConnected()&&(t.client.disconnect(),t.client=null),console.log("已经断开连接！"),t.connState=!1,setTimeout(function(){t.connect()},5e3)},subscribe:function(t,e){if(!this.client||!this.client.isConnected())return console.log("当前尚未连接"),void this.connect();t.topic?this.client.subscribe(t.topic,{qos:Number(t.qos),onSuccess:function(i){t.msg=i,console.log(t.msg),t.result=!0,e&&e(t)},onFailure:function(i){128===i.errorCode[0]&&console.log("The topic cannot SUBSCRIBE for ACL Deny"),t.msg=i,console.log(i),t.result=!1,e&&e(t)}}):console.log("topic为空！")},unsubscribe:function(t,e){return this.client&&this.client.isConnected()?t.topic?void this.client.unsubscribe(t.topic,{onSuccess:function(i){t.msg=i,console.log(t),t.result=!0,e&&e(t)},onFailure:function(i){t.msg=i,console.log(i),t.result=!0,e&&e(t)}}):(this.tablelist.push({date:a(new Date,"yyyy-MM-dd hh:mm"),content:"topic为空！"}),void console.log("topic为空！")):(this.tablelist.push({date:a(new Date,"yyyy-MM-dd hh:mm"),content:"当前尚未连接"}),console.log("当前尚未连接"),void this.connect())},sendMessage:function(t){var e=t.text;if(!this.client||!this.client.isConnected())return console.log("当前尚未连接"),void this.connect();if(t.topic)if(e){var i=new Paho.MQTT.Message(e);i.destinationName=t.topic,i.qos=Number(t.qos),i.retained=t.retained,this.client.send(i),console.log(t)}else console.log("消息内容为空！");else console.log("topic为空！")}}}}]);