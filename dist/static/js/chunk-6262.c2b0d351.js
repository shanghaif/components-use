(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6262"],{"2tzF":function(e,t,n){"use strict";var a=n("NapC");n.n(a).a},NapC:function(e,t,n){},S4dx:function(e,t,n){},itRl:function(e,t,n){"use strict";var a=n("4d7F"),l=n.n(a),i=n("Kw5r");function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,a=void 0===n?null:n,l=t.preIndex,o=void 0!==l&&l,s=t.level,c=void 0===s?0:s,d=t.expand,u=void 0!==d&&d,p=t.children,f=void 0===p?"children":p,h=t.show,m=void 0===h||h,v=t.select,_=void 0!==v&&v;e.forEach(function(e,t){var n=(o?o+"-"+t:t)+"";i.default.set(e,"_id",n),i.default.set(e,"_level",c),i.default.set(e,"_expand",u),i.default.set(e,"_parent",a),i.default.set(e,"_show",m),i.default.set(e,"_select",_),e[f]&&e[f].length>0&&r(e[f],{parent:e,level:c+1,expand:u,preIndex:n,children:f,status:status,select:_})})}var o={name:"TreeTable",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:"children"},indent:{type:Number,default:50}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(r(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",a=[];return t.forEach(function(t,l){if(i.default.set(t,"_index",l),a.push(t),t[n]&&t[n].length>0){var r=e(t[n],n);a=a.concat(r)}}),a}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,"children",[]),e.children.push(t)},delete:function(e){var t=e._index,n=e._parent;n?n.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,n=t._parent,a=!n||n._expand&&n._show;return t._show=a,a?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],n=!t._expand;t._expand=n},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";t&&(this.$set(e,"_expand",!0),this.$set(e,"_show",!0));var l=e[a];l&&l.length>0&&l.map(function(e){e._select=t,n.selcetRecursion(e,t,a)})},updateTreeNode:function(e){var t=this;return new l.a(function(n){var a=e._id,l=e._parent,i=a.split("-").slice(-1)[0];l?(l.children.splice(i,1,e),n(t.data)):(t.data.splice(i,1,e),n(t.data))})}}},s=(n("x7Y3"),n("KHd+")),c=Object(s.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._g(e._b({attrs:{data:e.tableData,"row-style":e.showRow}},"el-table",e.$attrs,!1),e.$listeners),[e._t("selection"),e._v(" "),e._t("pre-column"),e._v(" "),e._l(e.columns,function(t){return n("el-table-column",{key:t.key,attrs:{label:t.label,width:t.width,align:t.align||"center","header-align":t.headerAlign},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.key,[t.expand?[n("span",{style:{"padding-left":+a.row._level*e.indent+"px"}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showSperadIcon(a.row),expression:"showSperadIcon(scope.row)"}],staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(a.$index)}}},[a.row._expand?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})])]:e._e(),e._v(" "),t.checkbox?[a.row[e.defaultChildren]&&a.row[e.defaultChildren].length>0?n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},attrs:{indeterminate:a.row._select},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}}):n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}})]:e._e(),e._v("\n        "+e._s(a.row[t.key])+"\n      ")],{scope:a})]}}])})})],2)},[],!1,null,null,null);c.options.__file="index.vue";t.a=c.exports},jekg:function(e,t,n){"use strict";n.r(t);var a=n("gDS+"),l=n.n(a),i=n("itRl");n("t3Un");var r=n("v0iw"),o=n.n(r),s={components:{treeTable:i.a},data:function(){return{formLabelWidth:"120px",roleEdit:!1,form:{name:"",alias:"",description:""},search:"",defaultExpandAll:!1,key:1,permissionid:"",columns:[{label:"名称",key:"name",expand:!0,align:"left"},{label:"别名",key:"alias",width:200,align:"center"},{label:"创建日期",key:"scope"},{label:"操作",key:"operation"}],data:[]}},computed:{treeData:function(){var e=JSON.parse(l()(this.data));return e.filter(function(t){var n=e.filter(function(e){return t.objectId==e.parent});return n.length>0&&(t.children=n),0==t.parent})}},mounted:function(){this.getcontrolrole()},methods:{handleEdit:function(e){var t=this;this.permissionid=e.objectId;var n=o.a.Object.extend("Permission");new o.a.Query(n).get(e.objectId).then(function(e){t.form.name=e.attributes.name,t.form.description=e.attributes.description,t.form.alias=e.attributes.alias,t.roleEdit=!0})},handleDelete:function(e){},addcontrol:function(){},getcontrolrole:function(){var e=this;this.data=[];var t=o.a.Object.extend("Permission"),n=new o.a.Query(t);n.limit(1e3),n.find().then(function(t){t.map(function(t){var n={};n.name=t.attributes.name,n.alias=t.attributes.alias,n.objectId=t.id,n.parent=t.attributes.parent.id,n.createtime=new Date(t.attributes.createdAt).toLocaleDateString(),e.data.push(n)})})},updaterole:function(){var e=this,t=o.a.Object.extend("Permission");new o.a.Query(t).get(this.permissionid).then(function(t){t.set("alias",e.form.alias),t.set("description",e.form.description),t.save().then(function(t){e.$message({type:"success",message:"更新成功"})}),e.roleEdit=!1,e.getcontrolrole()})}}},c=(n("2tzF"),n("KHd+")),d=Object(c.a)(s,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"rolescontrol"},[n("div",{staticClass:"search"},[n("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"}},[e._v("搜 索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addcontrol}},[e._v("新 增")])],1),e._v(" "),n("tree-table",{key:e.key,staticStyle:{"margin-top":"20px"},attrs:{"default-expand-all":e.defaultExpandAll,data:e.treeData,columns:e.columns},scopedSlots:e._u([{key:"scope",fn:function(t){var a=t.scope;return[n("el-tag",[e._v(e._s(a.row.createtime))])]}},{key:"operation",fn:function(t){var a=t.scope;return[n("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-edit"},on:{click:function(t){e.handleEdit(a.row)}}},[e._v("编 辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",disabled:""},on:{click:function(t){e.handleDelete(a.row)}}},[e._v("删 除")])]}}])}),e._v(" "),n("el-dialog",{attrs:{title:"编辑权限",visible:e.roleEdit},on:{"update:visible":function(t){e.roleEdit=t}}},[n("el-form",{attrs:{model:e.form}},[n("el-form-item",{attrs:{label:"权限名称","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限备注","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限描述","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",type:"textarea",rows:2},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.roleEdit=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.updaterole}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"e869b7d6",null);d.options.__file="rolescontrol.vue";t.default=d.exports},x7Y3:function(e,t,n){"use strict";var a=n("S4dx");n.n(a).a}}]);