(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d112"],{"0Fdp":function(e,t,l){"use strict";l.r(t);var i,s,o={data:function(){return{dialogFormVisible:!1,title:"",formInline:{user:"",region:"",enginesql:"",remarks:"",sqltest:!1,clientid:"c_swqx",username:"u_swqx",qos:1,topic:"t/a",payload:"",row1:24,row2:0,result:""},formlinerule:{region:[{required:!0,message:"请选择触发事件",trigger:"change"}],enginesql:[{required:!0,message:"请填写规则SQL",trigger:"blur"}]},actiondata:[],form:{action:""},formrule:{action:[{required:!0,message:"请选择动作",trigger:"change"}]}}},mounted:function(){this.title=this.$route.query.title,(i=ace.edit("editor1")).session.setMode("ace/mode/json"),i.setTheme("ace/theme/eclipse"),i.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0})},methods:{getEditor2:function(e){1==e?(this.row1=12,this.row2=12,setTimeout(function(){(s=ace.edit("editor2")).session.setMode("ace/mode/json"),s.setTheme("ace/theme/eclipse"),s.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0})},0)):(this.row1=24,this.row2=0)}}},a=(l("tyOt"),l("KHd+")),n=Object(a.a)(o,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"addengine"},[l("div",{staticClass:"addcontent"},[l("el-card",{staticClass:"box-card"},[l("el-form",{ref:"formInline",attrs:{model:e.formInline,"label-width":"80px",rules:e.formlinerule,size:"medium"}},[l("div",{staticClass:"form-block__title"},[e._v("\n          条件\n          "),l("div",{staticClass:"form-block__title-tips"},[e._v("使用 SQL 定义规则条件与数据处理方式")])]),e._v(" "),l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:e.row1}},[l("el-form-item",{attrs:{label:"触发事件",prop:"region"}},[l("el-select",{attrs:{placeholder:"触发事件"},model:{value:e.formInline.region,callback:function(t){e.$set(e.formInline,"region",t)},expression:"formInline.region"}},[l("el-option",{attrs:{label:"区域一",value:"shanghai"}}),e._v(" "),l("el-option",{attrs:{label:"区域二",value:"beijing"}})],1),e._v(" "),l("div",{staticClass:"show-guess"},[l("p",[e._v("可用字段")]),e._v(" "),l("div",{staticClass:"code"},[l("code",{staticStyle:{"font-size":"12px"}},[e._v("clientid, username, event, id, payload, peername, qos, timestamp, topic")])]),e._v(" "),l("p",[l("span",{staticClass:"notice",staticStyle:{color:"#ff6d6d"}},[e._v("*")]),e._v(" 升级提示\n                ")]),e._v(" "),l("div",{staticClass:"code"},[e._v("当前版本取消对 payload 的自动 JSON 解码，选择 payload 中的字段请使用 json_decode 解码，如 SQL 示例。")]),e._v(" "),l("p",[e._v("规则 SQL 示例")]),e._v(" "),l("div",{staticClass:"code"},[l("code",{staticStyle:{"font-size":"12px"}},[e._v("SELECT * FROM \"message.publish\" WHERE topic =~ 't/#'")])])])],1),e._v(" "),l("el-form-item",{attrs:{label:"规则SQL",prop:"enginesql"}},[l("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor1"}},[l("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.enginesql,callback:function(t){e.$set(e.formInline,"enginesql",t)},expression:"formInline.enginesql"}})],1)]),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"text"},model:{value:e.formInline.remarks,callback:function(t){e.$set(e.formInline,"remarks",t)},expression:"formInline.remarks"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"SQL测试"}},[l("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"gray"},on:{change:e.getEditor2},model:{value:e.formInline.sqltest,callback:function(t){e.$set(e.formInline,"sqltest",t)},expression:"formInline.sqltest"}}),e._v(" "),l("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"自定义模拟数据进行 SQL 命令测试，仅用于测试功能"}},[l("i",{staticClass:"el-icon-question",staticStyle:{color:"#71737d"},attrs:{slot:"reference"},slot:"reference"})])],1)],1),e._v(" "),l("el-col",{attrs:{span:4}}),e._v(" "),l("el-col",{staticClass:"animated fadeInRightBig",attrs:{span:e.row2}},[1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"clientid",prop:"clientid",rules:[{required:!0,message:"clientid 不能为空",trigger:"blur"}]}},[l("el-input",{model:{value:e.formInline.clientid,callback:function(t){e.$set(e.formInline,"clientid",t)},expression:"formInline.clientid"}})],1):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"username",prop:"username",rules:[{required:!0,message:"username 不能为空",trigger:"blur"}]}},[l("el-input",{model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"topic",prop:"topic",rules:[{required:!0,message:"topic 不能为空",trigger:"blur"}]}},[l("el-input",{model:{value:e.formInline.topic,callback:function(t){e.$set(e.formInline,"topic",t)},expression:"formInline.topic"}})],1):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"qos",prop:"qos",rules:[{required:!0,message:"qos 不能为空",trigger:"blur"}]}},[l("el-input",{model:{value:e.formInline.qos,callback:function(t){e.$set(e.formInline,"qos",e._n(t))},expression:"formInline.qos"}})],1):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"payload",prop:"payload",rules:[{required:!0,message:"请填写payload",trigger:"blur"}]}},[l("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor2"}},[l("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.payload,callback:function(t){e.$set(e.formInline,"payload",t)},expression:"formInline.payload"}})],1)]):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:" "}},[l("el-button",{attrs:{type:"success"}},[e._v("测试")])],1):e._e(),e._v(" "),1==e.formInline.sqltest?l("el-form-item",{attrs:{label:"测试结果"}},[l("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.formInline.result,callback:function(t){e.$set(e.formInline,"result",t)},expression:"formInline.result"}})],1):e._e()],1)],1),e._v(" "),l("div",{staticClass:"tablebottom"},[l("div",{staticClass:"form-block__title"},[l("span",{staticStyle:{color:"rgb(255, 109, 109)"}},[e._v("*")]),e._v("\n          响应动作\n              "),l("div",{staticClass:"form-block__title-tips"},[e._v("\n                  处理命中规则的消息\n              ")])]),e._v(" "),l("div",{staticClass:"bottomtable",staticStyle:{"padding-left":"20px"}},[l("div",{staticClass:"tableaction"},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.actionData}},[l("el-table-column",{attrs:{prop:"date",label:"类型",width:"180"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"参数",width:"180"}}),e._v(" "),l("el-table-column",{attrs:{prop:"address",label:"操作"}})],1),e._v(" "),l("div",[l("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"success",plain:"",icon:"el-icon-circle-plus-outline",size:"small"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加")])],1)],1)]),e._v(" "),l("div",[l("el-dialog",{attrs:{title:"响应动作",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{attrs:{model:e.form,rules:e.formrule}},[l("el-row",{staticStyle:{border:"0"}},[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"动作",prop:"action"}},[l("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"动作类型"}},[l("i",{staticClass:"el-icon-question",staticStyle:{color:"#71737d"},attrs:{slot:"reference"},slot:"reference"})]),e._v(" "),l("el-select",{model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}},[l("el-option",{attrs:{label:"111",value:"222"}})],1)],1)],1),e._v(" "),l("el-col",{attrs:{span:12}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("确 定")])],1)],1)],1)]),e._v(" "),l("el-form-item",{attrs:{"label-width":"0"}},[l("el-button",{attrs:{type:"success"}},[e._v("新建")]),e._v(" "),l("el-button",[e._v("取消")])],1)],1)],1)],1)])},[],!1,null,"573a5d64",null);n.options.__file="addengine.vue";t.default=n.exports},mE1u:function(e,t,l){},tyOt:function(e,t,l){"use strict";var i=l("mE1u");l.n(i).a}}]);