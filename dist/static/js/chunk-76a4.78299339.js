(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-76a4"],{XfoJ:function(t,e,n){"use strict";n.r(e);var o=n("xiB2"),s={data:function(){return{}},mounted:function(){this.GetFlat()},methods:{GetFlat:function(){o.a.cInfo.host="132.232.121.164",o.a.newClient(),o.a.connect()},Startserver:function(){window.location.href="shuwa://aidlserver/pump?id=123&rtsp=rtsp://admin:shuwa-fly-2019@192.168.2.138:554/cam/realmonitor?channel=1&subtype=0&username=test&password=test123"},Startclient:function(){window.location.href="shuwa://aidlclient/pump?id=123&mqtturl=tcp://132.232.121.164:1883&username=test&password=test123"},Startlive:function(){window.location.href="shuwa://rtspliving/pump?&rtspurl=rtsp://admin:shuwa-fly-2019@192.168.2.138:554/cam/realmonitor?channel=1&subtype=0&action=start&username=test&password=test123 "},dingyue:function(){var t={topic:"ni/tx/2",qos:0};o.a.subscribe({topic:"ni/rx/1",qos:0},function(e){e.result&&o.a.subscribe(t,function(t){t.result&&alert("订阅成功")})})}}},i=(n("o7L3"),n("KHd+")),a=Object(i.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flat"},[n("el-button",{attrs:{type:"primary"},on:{click:t.Startserver}},[t._v("启动服务端")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.Startclient}},[t._v("启动客服端")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.Startlive}},[t._v("启动视频直播")])],1)},[],!1,null,"5bf5fa20",null);a.options.__file="index.vue";e.default=a.exports},o7L3:function(t,e,n){"use strict";var o=n("pq0j");n.n(o).a},pq0j:function(t,e,n){},xiB2:function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"b",function(){return a});var o=n("gDS+"),s=n.n(o);function i(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var o in n)if(new RegExp("("+o+")").test(e)){var s=n[o]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?s:c(s))}return e}var a=[];function c(t){return("00"+t).substr(t.length)}var l={modName:"websocket",client:null,connState:!1,cInfo:{host:location.hostname,port:8083,clientId:"C_"+(new Date).getTime(),userName:"test",password:"test123",keepAlive:null,cleanSession:!0},sendInfo:"{}",tablelist:[],originrecivedata:[],send:function(){var t=JSON.parse(this.sendInfo);this.sendMessage(t)},log:function(t){try{t=JSON.parse(t)}catch(t){}_this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"onConnectionLost: "+s()(t)}),console.log(111)},newClient:function(){this.client=new Paho.MQTT.Client(this.cInfo.host,Number(this.cInfo.port),this.cInfo.clientId)},sslPort:function(){var t=this.cInfo.useSSL;this.cInfo.port=t?8084:8083},recive:function(t){var e=this,n=JSON.parse(t);e.originrecivedata.length=0,n.data.map(function(t){a.map(function(o){t.di==o.key&&e.originrecivedata.unshift({di:t.di,pn:t.pn,value:t.value,vcaddr:n.vcaddr,ts:function(t){var e=new Date(1e3*t);return e.getFullYear()+"-"+(e.getMonth()+1<=10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()+1<=10?"0"+e.getDate():e.getDate())+" "+(e.getHours()+1<=10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()+1<=10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()+1<=10?"0"+e.getSeconds():e.getSeconds())}(t.ts),meteraddr:t.meteraddr,diname:o.label,time:t.time,status:t.status})})}),console.log(e.originrecivedata)},connect:function(){var t=this;if(t.newClient(),t.client){t.client.onConnectionLost=function(e){0!==e.errorCode&&(t.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"onConnectionLost: "+s()(e.errorMessage)}),console.log("onConnectionLost: "+e.errorMessage)),t.disconnect()},t.client.onMessageArrived=function(e){try{e.msgString=e.payloadString}catch(t){e.msgString="Binary message("+e.payloadBytes.length+")"}t.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(e.payloadString)}),t.recive(e.payloadString)};var e={onFailure:function(e){t.connState=!1,t.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"连接失败"}),console.log("连接失败 "+e.errorMessage)},onSuccess:function(){t.connState=!0,t.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"连接成功"}),console.log("连接成功！")}},n=t.cInfo.userName,o=t.cInfo.password,a=t.cInfo.keepAlive,c=t.cInfo.cleanSession;n&&(e.userName=n),o&&(e.password=o),a&&(e.keepAliveInterval=Number(a)),e.cleanSession=c,t.client.connect(e)}},disconnect:function(){this.client&&this.client.isConnected()&&(this.client.disconnect(),this.client=null),this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"已断开连接"}),console.log("已经断开连接！"),this.connState=!1},subscribe:function(t,e){var n=this;return n.client&&n.client.isConnected()?t.topic?void n.client.subscribe(t.topic,{qos:Number(t.qos),onSuccess:function(o){t.msg=o,n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(t)}),console.log(t.msg),t.result=!0,e&&e(t)},onFailure:function(o){128===o.errorCode[0]&&console.log("The topic cannot SUBSCRIBE for ACL Deny"),t.msg=o,n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(o)}),console.log(o),t.result=!1,e&&e(t)}}):(n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"topic为空！"}),void console.log("topic为空！")):(n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"当前尚未连接"}),console.log("当前尚未连接"),void alert("当前尚未连接","请刷新页面"))},unsubscribe:function(t,e){var n=this;return n.client&&n.client.isConnected()?t.topic?void n.client.unsubscribe(t.topic,{onSuccess:function(o){t.msg=o,n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(t)}),console.log(t),t.result=!0,e&&e(t)},onFailure:function(o){t.msg=o,n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(o)}),console.log(o),t.result=!0,e&&e(t)}}):(n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"topic为空！"}),void console.log("topic为空！")):(n.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"当前尚未连接"}),void console.log("当前尚未连接"))},sendMessage:function(t){var e=t.text;if(!this.client||!this.client.isConnected())return this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"当前尚未连接"}),void console.log("当前尚未连接");if(!t.topic)return this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"topic为空！"}),void console.log("topic为空！");if(!e)return this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:"消息内容为空！"}),void console.log("消息内容为空！");var n=new Paho.MQTT.Message(e);n.destinationName=t.topic,n.qos=Number(t.qos),n.retained=t.retained,this.client.send(n),this.tablelist.push({date:i(new Date,"yyyy-MM-dd hh:mm"),content:s()(t)}),console.log(t)}}}}]);