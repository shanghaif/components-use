(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2e8a"],{"4zI8":function(e,t,n){"use strict";n.r(t);var a=n("GQeE"),l=n.n(a),r=n("gDS+"),i=n.n(r),o=n("YEIV"),s=n.n(o),c=n("itRl"),d=n("v0iw"),u={name:"TreeTableDemo",components:{treeTable:c.a},data:function(){return s()({departmentForm:{name:""},departmentid:"",formLabelWidth:"120px",departmentEdit:!1,defaultExpandAll:!1,showCheckbox:!0,key:1,treeprops:{value:"objectId",label:"name"},columns:[{label:"名称",key:"name",expand:!0},{label:"ID",key:"objectId",width:200,align:"center"},{label:"level",key:"scope"},{label:"创建时间",key:"createtime",align:"center"},{label:"操作",key:"operation"}],data:[],data1:[],search:"",dialogVisible:!1,tableData:[],form:{name:"",resource:"菜单",topname:"",departmentid:[],level:""},parent:"",current:"",options:[]},"departmentid",[])},computed:{treeData:function(){var e=JSON.parse(i()(this.data));return e.filter(function(t){var n=e.filter(function(e){return t.objectId==e.ParentId});return n.length>0&&(t.children=n),0==t.ParentId})}},watch:{showCheckbox:function(e){e?this.columns.unshift({label:"Checkbox",checkbox:!0}):this.columns.shift(),this.reset()}},mounted:function(){this.getDepartment()},methods:{standardName:function(){var e=this,t=new(d.Parse.Object.extend("Department"));0==this.form.departmentid.length?t.set("ParentId","0"):t.set("ParentId",this.form.departmentid[this.form.departmentid.length-1]),t.set("name",this.form.name),t.save().then(function(t){e.$message({message:"新增成功",type:"success"}),e.dialogVisible=!1,e.getDepartment()})},reset:function(){++this.key},click:function(e){console.log(e);var t=e.row,n=l()(t).map(function(e){return"<p>"+e+": "+t[e]+"</p>"}).join("");this.$notify({title:"Success",dangerouslyUseHTMLString:!0,message:n,type:"success"})},handleEdit:function(e){var t=this;this.departmentid=e.objectId;var n=d.Parse.Object.extend("Department");new d.Parse.Query(n).get(e.objectId).then(function(e){t.departmentEdit=!0,t.departmentForm.name=e.attributes.name})},handleDelete:function(e){var t=this;if(e.children)this.$message({type:"warning",message:"请先删除此菜单中的子部门!"});else{var n=d.Parse.Object.extend("Department");new d.Parse.Query(n).get(e.objectId).then(function(e){e.destroy().then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getDepartment()})})}},searchvalue:function(){},add:function(){this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1},getDepartment:function(){var e=this;this.data=[];var t=d.Parse.Object.extend("Department");new d.Parse.Query(t).find().then(function(t){t.map(function(t){var n={};t.createtime=new Date(t.attributes.createdAt).toLocaleDateString(),n.name=t.attributes.name,n.ParentId=t.attributes.ParentId,n.objectId=t.id,n.level=t.attributes.level,n.createtime=t.createtime,e.data.push(n)})})},updatedepartment:function(){var e=this,t=d.Parse.Object.extend("Department");new d.Parse.Query(t).get(this.departmentid).then(function(t){t.set("name",e.departmentForm.name),t.save().then(function(t){e.$message({type:"success",message:"更新成功"}),e.departmentEdit=!1,e.getDepartment()})})}}},p=(n("lkxB"),n("AhOV"),n("KHd+")),h=Object(p.a)(u,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"department"},[n("div",{staticClass:"search"},[n("el-input",{staticStyle:{wdith:"200px"},attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"}},[e._v("搜 索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.add()}}},[e._v("新 增")])],1),e._v(" "),n("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"上级"}},[n("el-cascader",{staticStyle:{width:"100%"},attrs:{placeholder:"如果不选择则为顶级",props:e.treeprops,options:e.treeData,"show-all-levels":!1,"change-on-select":""},model:{value:e.form.departmentid,callback:function(t){e.$set(e.form,"departmentid",t)},expression:"form.departmentid"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Level"}},[n("el-input",{model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.standardName}},[e._v("确 定")])],1)],1),e._v(" "),n("tree-table",{key:e.key,staticStyle:{"margin-top":"20px"},attrs:{"default-expand-all":e.defaultExpandAll,data:e.treeData,columns:e.columns,border:""},scopedSlots:e._u([{key:"scope",fn:function(t){var a=t.scope;return[n("el-tag",[e._v(e._s(a.row.level))])]}},{key:"operation",fn:function(t){var a=t.scope;return[n("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-edit"},on:{click:function(t){e.handleEdit(a.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.handleDelete(a.row)}}},[e._v("删除")])]}}])}),e._v(" "),n("el-dialog",{attrs:{title:"编辑部门",visible:e.departmentEdit},on:{"update:visible":function(t){e.departmentEdit=t}}},[n("el-form",{attrs:{model:e.departmentForm}},[n("el-form-item",{attrs:{label:"部门名称","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.departmentForm.name,callback:function(t){e.$set(e.departmentForm,"name",t)},expression:"departmentForm.name"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.departmentEdit=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.updatedepartment}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"0ca6a462",null);h.options.__file="department.vue";t.default=h.exports},"7PfZ":function(e,t,n){},AhOV:function(e,t,n){"use strict";var a=n("vo2A");n.n(a).a},GQeE:function(e,t,n){e.exports={default:n("iq4v"),__esModule:!0}},Mqbl:function(e,t,n){var a=n("JB68"),l=n("w6GO");n("zn7N")("keys",function(){return function(e){return l(a(e))}})},S4dx:function(e,t,n){},iq4v:function(e,t,n){n("Mqbl"),e.exports=n("WEpk").Object.keys},itRl:function(e,t,n){"use strict";var a=n("4d7F"),l=n.n(a),r=n("Kw5r");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,a=void 0===n?null:n,l=t.preIndex,o=void 0!==l&&l,s=t.level,c=void 0===s?0:s,d=t.expand,u=void 0!==d&&d,p=t.children,h=void 0===p?"children":p,f=t.show,m=void 0===f||f,v=t.select,b=void 0!==v&&v;e.forEach(function(e,t){var n=(o?o+"-"+t:t)+"";r.default.set(e,"_id",n),r.default.set(e,"_level",c),r.default.set(e,"_expand",u),r.default.set(e,"_parent",a),r.default.set(e,"_show",m),r.default.set(e,"_select",b),e[h]&&e[h].length>0&&i(e[h],{parent:e,level:c+1,expand:u,preIndex:n,children:h,status:status,select:b})})}var o={name:"TreeTable",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:"children"},indent:{type:Number,default:50}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(i(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",a=[];return t.forEach(function(t,l){if(r.default.set(t,"_index",l),a.push(t),t[n]&&t[n].length>0){var i=e(t[n],n);a=a.concat(i)}}),a}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,"children",[]),e.children.push(t)},delete:function(e){var t=e._index,n=e._parent;n?n.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,n=t._parent,a=!n||n._expand&&n._show;return t._show=a,a?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],n=!t._expand;t._expand=n},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";t&&(this.$set(e,"_expand",!0),this.$set(e,"_show",!0));var l=e[a];l&&l.length>0&&l.map(function(e){e._select=t,n.selcetRecursion(e,t,a)})},updateTreeNode:function(e){var t=this;return new l.a(function(n){var a=e._id,l=e._parent,r=a.split("-").slice(-1)[0];l?(l.children.splice(r,1,e),n(t.data)):(t.data.splice(r,1,e),n(t.data))})}}},s=(n("x7Y3"),n("KHd+")),c=Object(s.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._g(e._b({attrs:{data:e.tableData,"row-style":e.showRow}},"el-table",e.$attrs,!1),e.$listeners),[e._t("selection"),e._v(" "),e._t("pre-column"),e._v(" "),e._l(e.columns,function(t){return n("el-table-column",{key:t.key,attrs:{label:t.label,width:t.width,align:t.align||"center","header-align":t.headerAlign},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.key,[t.expand?[n("span",{style:{"padding-left":+a.row._level*e.indent+"px"}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showSperadIcon(a.row),expression:"showSperadIcon(scope.row)"}],staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(a.$index)}}},[a.row._expand?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})])]:e._e(),e._v(" "),t.checkbox?[a.row[e.defaultChildren]&&a.row[e.defaultChildren].length>0?n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},attrs:{indeterminate:a.row._select},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}}):n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}})]:e._e(),e._v("\n        "+e._s(a.row[t.key])+"\n      ")],{scope:a})]}}])})})],2)},[],!1,null,null,null);c.options.__file="index.vue";t.a=c.exports},lkxB:function(e,t,n){"use strict";var a=n("7PfZ");n.n(a).a},vo2A:function(e,t,n){},x7Y3:function(e,t,n){"use strict";var a=n("S4dx");n.n(a).a},zn7N:function(e,t,n){var a=n("Y7ZC"),l=n("WEpk"),r=n("KUxP");e.exports=function(e,t){var n=(l.Object||{})[e]||Object[e],i={};i[e]=t(n),a(a.S+a.F*r(function(){n(1)}),"Object",i)}}}]);