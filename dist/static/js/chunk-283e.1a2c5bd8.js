(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-283e"],{"EEQ/":function(e,t,n){"use strict";n.r(t);var a=n("GQeE"),i=n.n(a),r=n("itRl"),o=n("v0iw"),l={name:"TreeTableDemo",components:{treeTable:r.a},data:function(){return{MenuForm:{name:"",url:""},formLabelWidth:"120px",MenuEdit:!1,defaultExpandAll:!1,showCheckbox:!0,key:1,columns:[{label:"菜单名称",key:"name",expand:!0,align:"left"},{label:"ID",key:"objectId",width:200,align:"center"},{label:"上级菜单",key:"scope"},{label:"创建时间",key:"createtime",align:"center"},{label:"操作",key:"operation"}],data:[],search:"",dialogVisible:!1,tableData:[],form:{name:"",resource:"菜单",topname:"",menuroad:""},parent:"",current:"",options:[],parentmenu:[{id:"0",attributes:{name:"顶级菜单"}}],originacl:[]}},watch:{showCheckbox:function(e){e?this.columns.unshift({label:"Checkbox",checkbox:!0}):this.columns.shift(),this.reset()}},mounted:function(){this.getMenu(),console.log()},methods:{updatemenu:function(){var e=this,t=o.Parse.Object.extend("Menu");new o.Parse.Query(t).get(this.menuid).then(function(t){t.set("name",e.MenuForm.name),t.set("url",e.MenuForm.url),t.save().then(function(t){e.$message({message:"修改成功",type:"success"}),e.MenuEdit=!1,e.getMenu()})})},getuseracl:function(){var e=o.Parse.User.current().attributes.ACL.permissionsById,t=this;i()(e).forEach(function(e){"*"==e?t.originacl.push(e):e.indexOf("root")>-1&&t.originacl.push(e.substring(5))})},standardName:function(){var e=this,t={};t=0==this.form.topname?{id:"0",attributes:{name:"顶级菜单"}}:this.parentmenu.find(function(t){return t.id===e.form.topname});var n=new(o.Parse.Object.extend("Menu")),a=new o.Parse.ACL;n.set("name",this.form.name),n.set("parentId",t.id),n.set("group",t.attributes.name),a.setRoleReadAccess("root",!0),a.setRoleWriteAccess("root",!0),a.setRoleReadAccess("admin",!0),a.setRoleWriteAccess("admin",!0),n.save().then(function(t){e.$message({message:"新增成功",type:"success"}),e.dialogVisible=!1,e.getMenu()})},reset:function(){++this.key},click:function(e){console.log(e);var t=e.row,n=i()(t).map(function(e){return"<p>"+e+": "+t[e]+"</p>"}).join("");this.$notify({title:"Success",dangerouslyUseHTMLString:!0,message:n,type:"success"})},handleEdit:function(e){var t=this;this.menuid=e.objectId;var n=o.Parse.Object.extend("Menu");new o.Parse.Query(n).get(e.objectId).then(function(e){console.log(e),t.MenuEdit=!0,t.MenuForm.name=e.attributes.name,t.MenuForm.url=e.attributes.url})},handleDelete:function(e){var t=this;if(0==e.children.length){var n=o.Parse.Object.extend("Menu");new o.Parse.Query(n).get(e.objectId).then(function(e){e.destroy().then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getMenu()})})}else this.$message({type:"warning",message:"请先删除此菜单中的子菜单!"})},searchvalue:function(){},add:function(){var e=this;this.dialogVisible=!0;var t=o.Parse.Object.extend("Menu"),n=new o.Parse.Query(t);n.equalTo("parentId","0"),n.find().then(function(t){t.map(function(t){e.parentmenu.push(t)})})},handleClose:function(){this.dialogVisible=!1},addmenus:function(){},getMenu:function(){var e=this,t=o.Parse.Object.extend("Menu");new o.Parse.Query(t).find().then(function(t){e.data=[],e.orderresultes=t,t.map(function(t){0==t.attributes.parentId&&e.data.push({id:t.attributes.orderBy,name:t.attributes.name,parentMenu:t.attributes.group,parentId:t.attributes.parentId,objectId:t.id,children:[],createtime:new Date(t.createdAt).toLocaleDateString()})}),e.Menus()},function(t){console.log(t),"209"==t.code&&(e.$message({type:"warning",message:"登陆权限过期，请重新登录"}),e.$router.push({path:"/login"}))})},Menus:function(){var e=this;this.orderresultes.map(function(t){e.data.map(function(e){t.attributes.parentId==e.objectId&&e.children.push({id:t.attributes.orderBy,name:t.attributes.name,parentMenu:t.attributes.group,parentId:t.attributes.parentId,objectId:t.id,children:[],createtime:new Date(t.createdAt).toLocaleDateString()})})})}}},s=(n("SMCW"),n("w+CU"),n("KHd+")),c=Object(s.a)(l,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"test"},[n("div",{staticClass:"search"},[n("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"}},[e._v("搜 索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.add()}}},[e._v("新 增")])],1),e._v(" "),n("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"菜单名称"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"上级菜单"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.topname,callback:function(t){e.$set(e.form,"topname",t)},expression:"form.topname"}},e._l(e.parentmenu,function(e){return n("el-option",{key:e.value,attrs:{label:e.attributes.name,value:e.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"菜单路径"}},[n("el-input",{model:{value:e.form.menuroad,callback:function(t){e.$set(e.form,"menuroad",t)},expression:"form.menuroad"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.standardName}},[e._v("确 定")])],1)],1),e._v(" "),n("tree-table",{key:e.key,staticStyle:{"margin-top":"20px"},attrs:{"default-expand-all":e.defaultExpandAll,data:e.data,columns:e.columns,border:""},scopedSlots:e._u([{key:"scope",fn:function(t){var a=t.scope;return[n("el-tag",[e._v(e._s(a.row.parentMenu))])]}},{key:"operation",fn:function(t){var a=t.scope;return[n("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-edit"},on:{click:function(t){e.handleEdit(a.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.handleDelete(a.row)}}},[e._v("删除")])]}}])}),e._v(" "),n("el-dialog",{attrs:{title:"编辑菜单",visible:e.MenuEdit},on:{"update:visible":function(t){e.MenuEdit=t}}},[n("el-form",{attrs:{model:e.MenuForm}},[n("el-form-item",{attrs:{label:"菜单名称","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.MenuForm.name,callback:function(t){e.$set(e.MenuForm,"name",t)},expression:"MenuForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"菜单名称","label-width":e.formLabelWidth}},[n("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.MenuForm.url,callback:function(t){e.$set(e.MenuForm,"url",t)},expression:"MenuForm.url"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.MenuEdit=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.updatemenu}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"0b769be4",null);c.options.__file="test.vue";t.default=c.exports},GQeE:function(e,t,n){e.exports={default:n("iq4v"),__esModule:!0}},Mqbl:function(e,t,n){var a=n("JB68"),i=n("w6GO");n("zn7N")("keys",function(){return function(e){return i(a(e))}})},S4dx:function(e,t,n){},SMCW:function(e,t,n){"use strict";var a=n("bueW");n.n(a).a},UVSS:function(e,t,n){},bueW:function(e,t,n){},iq4v:function(e,t,n){n("Mqbl"),e.exports=n("WEpk").Object.keys},itRl:function(e,t,n){"use strict";var a=n("4d7F"),i=n.n(a),r=n("Kw5r");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,a=void 0===n?null:n,i=t.preIndex,l=void 0!==i&&i,s=t.level,c=void 0===s?0:s,u=t.expand,d=void 0!==u&&u,f=t.children,h=void 0===f?"children":f,p=t.show,m=void 0===p||p,b=t.select,v=void 0!==b&&b;e.forEach(function(e,t){var n=(l?l+"-"+t:t)+"";r.default.set(e,"_id",n),r.default.set(e,"_level",c),r.default.set(e,"_expand",d),r.default.set(e,"_parent",a),r.default.set(e,"_show",m),r.default.set(e,"_select",v),e[h]&&e[h].length>0&&o(e[h],{parent:e,level:c+1,expand:d,preIndex:n,children:h,status:status,select:v})})}var l={name:"TreeTable",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:"children"},indent:{type:Number,default:50}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(o(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",a=[];return t.forEach(function(t,i){if(r.default.set(t,"_index",i),a.push(t),t[n]&&t[n].length>0){var o=e(t[n],n);a=a.concat(o)}}),a}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,"children",[]),e.children.push(t)},delete:function(e){var t=e._index,n=e._parent;n?n.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,n=t._parent,a=!n||n._expand&&n._show;return t._show=a,a?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],n=!t._expand;t._expand=n},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";t&&(this.$set(e,"_expand",!0),this.$set(e,"_show",!0));var i=e[a];i&&i.length>0&&i.map(function(e){e._select=t,n.selcetRecursion(e,t,a)})},updateTreeNode:function(e){var t=this;return new i.a(function(n){var a=e._id,i=e._parent,r=a.split("-").slice(-1)[0];i?(i.children.splice(r,1,e),n(t.data)):(t.data.splice(r,1,e),n(t.data))})}}},s=(n("x7Y3"),n("KHd+")),c=Object(s.a)(l,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._g(e._b({attrs:{data:e.tableData,"row-style":e.showRow}},"el-table",e.$attrs,!1),e.$listeners),[e._t("selection"),e._v(" "),e._t("pre-column"),e._v(" "),e._l(e.columns,function(t){return n("el-table-column",{key:t.key,attrs:{label:t.label,width:t.width,align:t.align||"center","header-align":t.headerAlign},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.key,[t.expand?[n("span",{style:{"padding-left":+a.row._level*e.indent+"px"}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showSperadIcon(a.row),expression:"showSperadIcon(scope.row)"}],staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(a.$index)}}},[a.row._expand?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})])]:e._e(),e._v(" "),t.checkbox?[a.row[e.defaultChildren]&&a.row[e.defaultChildren].length>0?n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},attrs:{indeterminate:a.row._select},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}}):n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}})]:e._e(),e._v("\n        "+e._s(a.row[t.key])+"\n      ")],{scope:a})]}}])})})],2)},[],!1,null,null,null);c.options.__file="index.vue";t.a=c.exports},"w+CU":function(e,t,n){"use strict";var a=n("UVSS");n.n(a).a},x7Y3:function(e,t,n){"use strict";var a=n("S4dx");n.n(a).a},zn7N:function(e,t,n){var a=n("Y7ZC"),i=n("WEpk"),r=n("KUxP");e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),a(a.S+a.F*r(function(){n(1)}),"Object",o)}}}]);