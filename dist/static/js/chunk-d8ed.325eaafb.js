(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d8ed"],{"9oL+":function(t,e,a){"use strict";var n=a("lE++");a.n(n).a},"lE++":function(t,e,a){},lzw9:function(t,e,a){"use strict";a.d(e,"d",function(){return r}),a.d(e,"e",function(){return o}),a.d(e,"a",function(){return l}),a.d(e,"c",function(){return s}),a.d(e,"b",function(){return i});var n=a("t3Un");function r(t,e){return Object(n.a)({url:"/pump/templet?dataType=pump_report&start="+t+"&len="+e,method:"GET",data:{}})}function o(t){return Object(n.a)({url:"/pump/templet/"+t,method:"GET",data:{}})}function l(t,e){return Object(n.a)({url:"/pump/templet",method:"POST",data:{data:t,id:e,dataType:"pump_report"}})}function s(){return Object(n.a)({url:"/pump/templet?dataType=pump_report&start=0&len=1000",method:"GET",data:{}})}function i(t){return Object(n.a)({url:"/pump/report/config?reportId="+t,method:"GET",data:{}})}},zs8C:function(t,e,a){"use strict";a.r(e);var n=a("gDS+"),r=a.n(n),o=a("v0iw"),l=a.n(o),s=a("lzw9"),i={data:function(){return{taskData:[],pagesize:10,start:0,total:0,standard:"",form:{starttime:"",endtime:"",inspection_number:"",client:"",region:"",produt:"",model:"",standard:[],testbed:[],bedname:""},options:[{value:"浙江利欧",label:"浙江利欧"},{value:"南方泵业",label:"南方泵业"},{value:"新界泵业",label:"新界泵业"},{value:"丰球",label:"丰球"}],formLabelWidth:"120px",taskdialog:!1}},created:function(){},mounted:function(){this.getTasktable(this.pagesize,this.start)},methods:{getTasktable:function(t,e){var a=this;this.taskData=[];var n=l.a.Object.extend("Report"),o=new l.a.Query(n);o.descending("createdAt"),o.limit(t),o.skip(e),o.count().then(function(t){a.total=t,o.find().then(function(t){t.map(function(t){var e={};e=JSON.parse(r()(t));var n=l.a.Object.extend("Testbed");new l.a.Query(n).get(t.attributes.testbed).then(function(t){e.updatedAt=t.attributes.name}),a.taskData.push(e)}),console.log(a.taskData)})},function(t){console.log(t),a.$message({type:"error",message:t.message})})},addtask:function(){var t=this;this.taskdialog=!0;var e=l.a.Object.extend("Testbed");new l.a.Query(e).find().then(function(e){t.form.testbed=e}),Object(s.c)().then(function(e){e&&(t.form.standard=e.data)}).catch(function(e){t.$message({type:"error",message:e.error})})},handleSizeChange:function(t){this.pagesize=t},handleCurrentChange:function(t){this.start=Number(t-1)*Number(this.pagesize)},taskDetail:function(t,e){this.$router.push({path:"/inspection/reportdetail",query:{id:t,testbedid:e}})},standardName:function(){var t,e=this;t=this.form.standard.find(function(t){return r()(t.data)===e.form.region}),this.standard=t.data.inspection_standard},addBedtask:function(){var t=this;console.log();var e=new(l.a.Object.extend("Report"));e.set("inspection_number",this.form.inspection_number),e.set("client",this.form.client),e.set("produt",this.form.produt),e.set("model",this.form.model),e.set("testbed",this.form.bedname),e.set("standard",this.standard),e.set("datas",JSON.parse(this.form.region)),e.set("start_time",this.form.starttime/1e3),e.set("end_time",this.form.endtime/1e3),e.save().then(function(e){t.$message({message:"新增成功",type:"success"}),t.taskdialog=!1,t.getTasktable(t.pagesize,t.start)},function(e){t.$message({type:"error",message:e.message})})},derive:function(t){Object(s.b)(t).then(function(t){})}}},d=(a("9oL+"),a("KHd+")),u=Object(d.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inspection"},[a("div",{staticClass:"addtask"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addtask()}}},[t._v("新增任务")])],1),t._v(" "),a("div",{staticClass:"tasklist"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"index",label:"id"}}),t._v(" "),a("el-table-column",{attrs:{label:"检验编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.inspection_number))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"委托单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.client))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.produt))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"水泵型号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.model))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"测试台体"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.updatedAt))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"检验标准"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.standard))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(new Date(e.row.createdAt).toLocaleDateString()))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",label:"查看"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.taskDetail(e.row.objectId,e.row.testbed)}}},[t._v("详情")])]}}])})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,40],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-dialog",{attrs:{title:"新增检测任务",visible:t.taskdialog,width:"30%"},on:{"update:visible":function(e){t.taskdialog=e}}},[a("el-form",{attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"检验编号：","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请选择检验编号"},model:{value:t.form.inspection_number,callback:function(e){t.$set(t.form,"inspection_number",e)},expression:"form.inspection_number"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"委托单位：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择委托单位"},model:{value:t.form.client,callback:function(e){t.$set(t.form,"client",e)},expression:"form.client"}},t._l(t.options,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"产品名称：","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请选择产品名称"},model:{value:t.form.produt,callback:function(e){t.$set(t.form,"produt",e)},expression:"form.produt"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"水泵型号：","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请选择水泵型号"},model:{value:t.form.model,callback:function(e){t.$set(t.form,"model",e)},expression:"form.model"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"检验标准：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择检验标准"},on:{change:function(e){t.standardName()}},model:{value:t.form.region,callback:function(e){t.$set(t.form,"region",e)},expression:"form.region"}},t._l(t.form.standard,function(t,e){return a("el-option",{key:e,attrs:{label:t.data.inspection_standard,value:JSON.stringify(t.data)}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"测试台体：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择测试台体"},model:{value:t.form.bedname,callback:function(e){t.$set(t.form,"bedname",e)},expression:"form.bedname"}},t._l(t.form.testbed,function(t,e){return a("el-option",{key:e,attrs:{label:t.attributes.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间：","label-width":t.formLabelWidth}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间","value-format":"timestamp"},model:{value:t.form.starttime,callback:function(e){t.$set(t.form,"starttime",e)},expression:"form.starttime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间：","label-width":t.formLabelWidth}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间","value-format":"timestamp"},model:{value:t.form.endtime,callback:function(e){t.$set(t.form,"endtime",e)},expression:"form.endtime"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.taskdialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addBedtask()}}},[t._v("确 定")])],1)],1)],1)],1)])},[],!1,null,"b3891764",null);u.options.__file="Inspection.vue";e.default=u.exports}}]);